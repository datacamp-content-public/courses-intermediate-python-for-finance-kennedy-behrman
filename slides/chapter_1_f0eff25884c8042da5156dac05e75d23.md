---
key: f0eff25884c8042da5156dac05e75d23
title: 'Insert title here'
---

## Extending and Manipulating Data

```yaml
type: TitleSlide
key: 7e5cf81bb4
```

`@lower_third`
name: Kennedy Behrman
title: Founder Pragmatic AI Labs

`@script`
You have already seen how to create DataFrames, and how to access the data they contain. Now let's look at extending and manipulating that data.

---

## Adding and Removing Columns

```yaml
type: FullSlide
key: 83f547dbd2
disable_transition: false
```

`@part1`
A new columns from outside data
```
df['K'] = ['a', 'b', 'c', 'd', 'e', 'f', 'g','h', 'i', 'j']
df
```{{1}}

![](https://assets.datacamp.com/production/repositories/5146/datasets/b589c47f5728872a6ce375e6f7b647dc6f8c315e/Screen%20Shot%202019-06-19%20at%208.23.45%20AM.png){{2}}

`@script`
You can add a new column by just assigning data to it.

---

## Adding and Removing Columns

```yaml
type: FullSlide
key: 72ae1385b3
disable_transition: true
```

`@part1`
A new column based on an operation across existing ones
```
df['∆'] = df['Q4'] - df['Q3']
df
```{{1}}

![](https://assets.datacamp.com/production/repositories/5146/datasets/a4b878fb2645b986645d45df8b4cdcfa57fd3019/Screen%20Shot%202019-06-19%20at%208.25.40%20AM.png){{2}}

`@script`
Or you can create a new column by  manipulating data from existing columns. You will find this often comes up as you analyze the relationship between columns. Here we've added a column with the difference between Q3 and Q4.

---

## Adding and Removing Columns

```yaml
type: FullSlide
key: f14e9a728a
disable_transition: true
```

`@part1`
Column from a DataFrame
```df['N'] = pd.DataFrame(['n', 'o', 'p', 'q','r', 's'])
df```{{1}}

![](https://assets.datacamp.com/production/repositories/5146/datasets/7838d2fe29e68a37336fb991fd23c423008ccba6/Screen%20Shot%202019-06-19%20at%208.29.53%20AM.png){{2}}

`@script`
You can set data in a column from another DataFrame. The new data will line up using index values, so if we set index values in a new order, we will see our data inserted using that order.

---

## Adding and Removing Columns

```yaml
type: FullSlide
key: 45025c0ac0
disable_transition: true
```

`@part1`
Column from a DataFrame - Matching on the Index
```df['N'] = pd.DataFrame(['n', 'o', 'p', 'q','r', 's'], index=[5,4,3,2,1,0])
df
```{{1}}

![](https://assets.datacamp.com/production/repositories/5146/datasets/b73fcedf8b9893e31fbbc13bc9cab8ad206699e2/Screen%20Shot%202019-06-19%20at%208.32.34%20AM.png){{2}}

`@script`
Here, by specifying the index, we set the rows where the data is inserted, so 's' is now in row 0.

---

## Adding and Removing Columns

```yaml
type: FullSlide
key: 580eb278ae
disable_transition: true
```

`@part1`
Drop Method
```
df.drop(columns=['K','N'], axis=1)
```{{1}}

![](https://assets.datacamp.com/production/repositories/5146/datasets/7a8c5d44c2c2e863be3fe0cad4cae51c755caafc/Screen%20Shot%202019-06-19%20at%208.37.41%20AM.png){{2}}

`@script`
To remove a column, use the drop method. The axis argument is used to differentiate between columns and rows, with 1 indicating columns in this case. Note that this method returns a new DataFrame, it does not change the original one in place.

---

## Adding and Removing Columns

```yaml
type: FullSlide
key: 0938f92533
disable_transition: true
```

`@part1`
Drop Method - in place
```
df.drop(columns=['K','N'], inplace=True, axis=1)
df
```{{1}}

![](https://assets.datacamp.com/production/repositories/5146/datasets/a9680d0deece540abfc18fb12978761e5203d99f/Screen%20Shot%202019-06-19%20at%208.39.45%20AM.png){{2}}

`@script`
You can use the inplace argument to change the original DataFrame.

---

## Adding and Removing Rows

```yaml
type: TwoColumns
key: 05eaa29e0b
disable_transition: false
```

`@part1`
Appending Rows

Original DataFrame:{{1}}
```
df
```{{1}}

![](https://assets.datacamp.com/production/repositories/5146/datasets/98214a350be269e6bd06624c00bdf5ffd704da45/Screen%20Shot%202019-06-19%20at%208.44.31%20AM.png){{1}}

`@part2`
```df2 = pd.DataFrame([[34, 56, 23, 88, 65]], 
                    columns=['Q1','Q2','Q3','Q4','∆'])   df.append(df2)```{{2}}

![](https://assets.datacamp.com/production/repositories/5146/datasets/f47a1c9820e795bffca0f70eb045e50896d6ddb0/Screen%20Shot%202019-06-19%20at%208.48.50%20AM.png){{3}}

`@script`
You can append a new row to a DataFrame using another DataFrame's data. Notice that the index is taken from the new DataFrame, so we have two index zeros here.

---

## Adding and Removing Rows

```yaml
type: FullSlide
key: 7d180f0274
disable_transition: true
```

`@part1`
Appending Rows - Fixing Index

```df.append(df2, ignore_index=True)```{{1}}

![](https://assets.datacamp.com/production/repositories/5146/datasets/09184fdbf17bf2ef20a0fa7455161a5b06b7140a/Screen%20Shot%202019-06-19%20at%208.55.12%20AM.png){{2}}


`@script`
You can use the ignore_index argument to generate a new index. Notice that our new row's index is now a new value.

---

## Adding and Removing Rows

```yaml
type: FullSlide
key: 3a3cca73b5
disable_transition: true
```

`@part1`
Adding Multiple Rows

```
new_rows = [pd.DataFrame([[22, 44, 66, 88, 22]], columns=['Q1','Q2','Q3','Q4', '∆']),
            pd.DataFrame([[54, 45, 66, 88, 22]], columns=['Q1','Q2','Q3','Q4', '∆']),
            pd.DataFrame([[44, 60, 60, 88, 28]], columns=['Q1','Q2','Q3','Q4', '∆'])]

df3 = df
for new_row in new_rows:
    df3 = df3.append(new_row, ignore_index=True)
df3
```{{1}}

![](https://assets.datacamp.com/production/repositories/5146/datasets/a2e387c8898123101f14e79430ca4e5bfbc0fa5f/Screen%20Shot%202019-06-19%20at%209.05.44%20AM.png){{2}}

`@script`
Here we iterate through a list of DataFrames, adding multiple rows. This is not recommended if you are adding a large number of rows or if your DataFrame itself is large.

---

## Adding and Removing Rows

```yaml
type: FullSlide
key: 758873ffd3
disable_transition: true
```

`@part1`
Adding Multiple Rows - Using Concat
```
# More efficient use concat
all_rows = [df,
            pd.DataFrame([[22, 44, 66, 88, 22]], columns=['Q1','Q2','Q3','Q4', '∆']),
            pd.DataFrame([[54, 45, 66, 88, 22]], columns=['Q1','Q2','Q3','Q4', '∆']),
            pd.DataFrame([[44, 60, 60, 88, 28]], columns=['Q1','Q2','Q3','Q4', '∆'])]


df = pd.concat(all_rows, ignore_index=True)
```{{1}}


`@script`
The pandas concat function is more efficient at adding multiple rows. Here we add our original dataframe to a list of dataframes and concat them all into a new dataframe.

---

## Adding and Removing Rows

```yaml
type: TwoColumns
key: b16675823c
disable_transition: true
```

`@part1`
Dropping Row

```
df.drop(3, inplace=True)
df```{{1}}

![](https://assets.datacamp.com/production/repositories/5146/datasets/ef549a5cb65eb6792c3391a6be66f74363228511/Screen%20Shot%202019-06-19%20at%209.12.36%20AM.png){{2}}


`@part2`
Dropping Range of Rows{{3}}

```df.drop(df.index[2:])```{{3}}

![](https://assets.datacamp.com/production/repositories/5146/datasets/889905d49530402aceb219c647d96a39a8540728/Screen%20Shot%202019-06-19%20at%209.15.08%20AM.png){{4}}

`@script`
You can remove rows using the drop method. It takes either a single index number, or a sequence of indices. If you wish to drop a range of rows, use the Dataframe index to select a slice to drop.

---

## Operations on DataFrames

```yaml
type: TwoColumns
key: fbf095c5f7
disable_transition: false
```

`@part1`

```
df
```{{1}}

![](https://assets.datacamp.com/production/repositories/5146/datasets/fb2bfd5659a5b2517fa03277cd36a8a697f19f8c/Screen%20Shot%202019-06-19%20at%209.22.24%20AM.png){{2}}

`@part2`
```
df * 2
```{{3}}

![](https://assets.datacamp.com/production/repositories/5146/datasets/db50b87a11f63ebfe46c8257cf9d085965dc4999/Screen%20Shot%202019-06-19%20at%209.23.19%20AM.png){{4}}

`@script`
Much as you have seen with numpy arrays, mathematical operations on DataFrames will work on the data, rather than on the object. If we take this dataframe, and multiply it by two, you can see that the operation is performed on each item.

---

## Operations on DataFrames

```yaml
type: TwoColumns
key: cc23427ea4
disable_transition: true
```

`@part1`

```
df
```

![](https://assets.datacamp.com/production/repositories/5146/datasets/fb2bfd5659a5b2517fa03277cd36a8a697f19f8c/Screen%20Shot%202019-06-19%20at%209.22.24%20AM.png)

`@part2`
```
df['Q1'] // 2
```{{2}}

![](https://assets.datacamp.com/production/repositories/5146/datasets/85ad083c519c976148dacceedbb3933c5ca1bb5f/Screen%20Shot%202019-06-19%20at%209.27.35%20AM.png){{2}}

`@script`
You can also perform operations on the data in a single column.

---

## Map

```yaml
type: TwoColumns
key: 2e25fce42e
```

`@part1`
```
df
```{{1}}

![](https://assets.datacamp.com/production/repositories/5146/datasets/f4ef3281a63915604c52c217872aa2f48e927e7f/Screen%20Shot%202019-06-19%20at%209.35.48%20AM.png){{1}}

```
def update_convention(x):
    return abs(x)
```{{2}}


`@part2`
```
df['∆'] = df['∆'].map(update_convention)
df
```{{3}}

![](https://assets.datacamp.com/production/repositories/5146/datasets/a786ab442c4987f3159d555e7f0abceb495fed89/Screen%20Shot%202019-06-19%20at%209.38.20%20AM.png){{4}}

`@script`
Often, especially with third party data, you will wish to transform the data in a column. You can use the map method to apply a function across the items in a column. Here is our original DataFrame. Here is a function which returns the absolute value of a number. By passing it to map, we call it on all of the items in the specified column.

---

## Apply

```yaml
type: TwoColumns
key: f4aabb3fa5
```

`@part1`
```
df
```{{1}}

![](https://assets.datacamp.com/production/repositories/5146/datasets/1df8a94386bbf95c17aec4ce743ca890b744233e/Screen%20Shot%202019-06-19%20at%209.42.29%20AM.png){{1}}

`@part2`
```
df.apply(np.sum, axis=1)
```{{2}}

![](https://assets.datacamp.com/production/repositories/5146/datasets/4d5e5d779ad35f68e9fdf505b7617b080577f617/Screen%20Shot%202019-06-19%20at%209.45.22%20AM.png){{3}}

`@script`
While map calls a function on each individual item, apply calls a function on all of the items in a row or column. Here is a DataFrame. Here we call the numpy sum function on the rows by using a axis value of 1. You can see that the result is the sum of each row, indexed by the row's index.

---

## Apply - Columns

```yaml
type: TwoColumns
key: 13981dce06
disable_transition: true
```

`@part1`
```
df
```

![](https://assets.datacamp.com/production/repositories/5146/datasets/1df8a94386bbf95c17aec4ce743ca890b744233e/Screen%20Shot%202019-06-19%20at%209.42.29%20AM.png)

`@part2`
```
df.apply(np.sum, axis=0)
```{{1}}

![](https://assets.datacamp.com/production/repositories/5146/datasets/8010028ca0aabf82343df546da3d981d6f42d1e6/Screen%20Shot%202019-06-19%20at%209.49.11%20AM.png){{2}}

`@script`
Now let's set the axis to zero. The result is the sum of all of the columns, indexed by the column names.

---

## Let's practice!

```yaml
type: FinalSlide
key: e5ba3b5404
```

`@script`
It's time to practice modifying DataFrame data.
